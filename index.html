<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>raveVM</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 10px;
        }
        button {
            margin-right: 10px;
        }
        pre {
            background-color: #f0f0f0;
            padding: 10px;
            border: 1px solid #ccc;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>

<h1>RaveVM - Demo</h1>

<textarea id="javaInput" placeholder="Enter your Java code here..."></textarea>
<button id="translateBtn">Translate</button>
<button id="copyBtn">Copy Code</button>

<h2>Python Output:</h2>
<pre id="pythonOutput"></pre>

<script>
    class Token {
        constructor(type, value) {
            this.type = type;
            this.value = value;
        }
    }

    class Lexer {
        constructor(input) {
            this.input = input;
            this.current = 0;
        }

        nextToken() {
            while (this.current < this.input.length) {
                const char = this.input[this.current];

                // Skip whitespace
                if (/\s/.test(char)) {
                    this.current++;
                    continue;
                }

                // Handle keywords, identifiers, and types
                if (/[a-zA-Z]/.test(char)) {
                    let start = this.current;
                    while (/[a-zA-Z0-9]/.test(this.input[this.current])) {
                        this.current++;
                    }
                    const value = this.input.slice(start, this.current);
                    return new Token('IDENTIFIER', value);
                }

                // Handle symbols
                switch (char) {
                    case '{': this.current++; return new Token('LBRACE', '{');
                    case '}': this.current++; return new Token('RBRACE', '}');
                    case ';': this.current++; return new Token('SEMICOLON', ';');
                    case '(': this.current++; return new Token('LPAREN', '(');
                    case ')': this.current++; return new Token('RPAREN', ')');
                    case '=': this.current++; return new Token('ASSIGN', '=');
                    case '+': this.current++; return new Token('PLUS', '+');
                    case '-': this.current++; return new Token('MINUS', '-');
                    case '*': this.current++; return new Token('MULTIPLY', '*');
                    case '/': this.current++; return new Token('DIVIDE', '/');
                }

                if (char === 'i' && this.input.substr(this.current, 1) === 'f') {
                    this.current += 2;
                    return new Token('IF', 'if');
                }

                throw new Error(`Unexpected character: ${char}`);
            }

            return new Token('EOF', null);
        }
    }

    class Parser {
        constructor(lexer) {
            this.lexer = lexer;
            this.currentToken = this.lexer.nextToken();
        }

        parse() {
            const statements = [];
            while (this.currentToken.type !== 'EOF') {
                statements.push(this.statement());
            }
            return statements;
        }

        statement() {
            if (this.currentToken.type === 'IF') {
                return this.ifStatement();
            } else if (this.currentToken.type === 'IDENTIFIER') {
                return this.assignment();
            }
            throw new Error('Unknown statement type');
        }

        ifStatement() {
            this.eat('IF');
            this.eat('LPAREN');
            const condition = this.currentToken.value; // Simplified for demo
            this.eat('IDENTIFIER'); // consume condition
            this.eat('RPAREN');
            this.eat('LBRACE');
            const body = this.body();
            this.eat('RBRACE');
            return { type: 'IF', condition, body };
        }

        assignment() {
            const varName = this.currentToken.value;
            this.eat('IDENTIFIER');
            this.eat('ASSIGN');
            const value = this.currentToken.value; // Simplified for demo
            this.eat('IDENTIFIER'); // consume value
            this.eat('SEMICOLON');
            return { type: 'ASSIGNMENT', varName, value };
        }

        body() {
            const statements = [];
            while (this.currentToken.type !== 'RBRACE') {
                if (this.currentToken.type === 'IDENTIFIER') {
                    statements.push(this.assignment());
                }
                if (this.currentToken.type === 'IF') {
                    statements.push(this.ifStatement());
                }
            }
            return statements;
        }

        eat(tokenType) {
            if (this.currentToken.type === tokenType) {
                const token = this.currentToken;
                this.currentToken = this.lexer.nextToken();
                return token;
            }
            throw new Error(`Expected token type: ${tokenType}, got: ${this.currentToken.type}`);
        }
    }

    class JavaToPythonConverter {
        convert(javaCode) {
            const lexer = new Lexer(javaCode);
            const parser = new Parser(lexer);
            const ast = parser.parse();
            return this.generatePython(ast);
        }

        generatePython(statements) {
            return statements.map(statement => {
                if (statement.type === 'IF') {
                    return `if ${statement.condition}:\n    ${statement.body.map(stmt => `${stmt.varName} = ${stmt.value}`).join('\n    ')}`;
                } else if (statement.type === 'ASSIGNMENT') {
                    return `${statement.varName} = ${statement.value}`;
                }
                return '';
            }).join('\n');
        }
    }

    document.getElementById('translateBtn').addEventListener('click', function() {
        const javaCode = document.getElementById('javaInput').value;
        const converter = new JavaToPythonConverter();
        const pythonCode = converter.convert(javaCode);
        document.getElementById('pythonOutput').textContent = pythonCode;
    });

    document.getElementById('copyBtn').addEventListener('click', function() {
        const pythonCode = document.getElementById('pythonOutput').textContent;
        navigator.clipboard.writeText(pythonCode).then(function() {
            alert('Python code copied to clipboard!');
        }, function(err) {
            console.error('Could not copy text: ', err);
        });
    });
</script>

</body>
</html>
